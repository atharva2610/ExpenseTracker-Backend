{% extends "base.html" %}

{% block Content %}
<section class="p-4">
    <h3 class="my-4 text-xl text-slate-950 mb-8">Monthly Transactions Report</h3>

    <div class="flex flex-col md:flex-row items-center md:items-start lg:justify-around gap-16">
        <form method="POST" action="" class="flex flex-col items-center gap-4">
            {% csrf_token %}

            {% comment %} ---- field contianer ---- {% endcomment %}
            <div class="flex flex-col gap-2">
                <label class="font-semibold text-md">Month</label>
                <input type="month" name="month" autofocus required class="w-screen max-w-sm p-3 rounded-lg border-2 border-stone-300 text-lg focus:ring-2 focus:ring-pink-600 outline-none">
                {% if errors %}
                <div class="flex flex-col gap-2 my-1">
                    {% for field, field_errors in errors %}
                        {% if field == 'month' %}
                            {% for err in field_errors %}
                            <span class="font-semibold text-sm text-red-600">{{err}}</span>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <div class="w-full my-2">
                <label class="cursor-pointer">
                    <input type="checkbox" name="generate_report" class="accent-pink-600 size-4">
                    <span class="text-lg text-slate-950">Generate Report</span>
                </label>
            </div>

            <button class="w-screen max-w-sm p-3 rounded-lg bg-pink-600 text-lg text-white cursor-pointer hover:bg-pink-600" type="submit">Download CSV</button>
        </form>

        <table>
            <thead class="text-md text-slate-600">
                <td class="font-semibold border border-gray-300 p-2">Month</td>
                <td class="font-semibold border border-gray-300 p-2">Total Credit</td>
                <td class="font-semibold border border-gray-300 p-2">Total Debit</td>
                <td class="font-semibold border border-gray-300 p-2">Net Balance</td>
                <td class="font-semibold border border-gray-300 p-2">Latest</td>
            </thead>
            <tbody class="text-md text-slate-950">
                {% for record in reports_list %}
                <tr>
                    <td class="border border-gray-300 p-2">{{record.month_year}}</td>
                    <td class="border border-gray-300 p-2">{{record.total_credit}}</td>
                    <td class="border border-gray-300 p-2">{{record.total_debit}}</td>
                    <td class="border border-gray-300 p-2">{{record.net_balance}}</td>
                    {% if not record.is_dirty %}
                    <td class="border border-gray-300 p-2 text-red-600 leading-none text-center"><span class="material-symbols-rounded">cancel</span></td>
                    <td class="border border-gray-300 p-2 text-pink-600 font-semibold underline"><a href="{% url 'update_report' record.id %}">update</a></td>
                    {% else %}
                    <td class="border border-gray-300 p-2 text-green-600 leading-none text-center"><span class="material-symbols-rounded">check_circle</span></td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endblock Content %}